<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-EEMGV1LKN1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-EEMGV1LKN1');
  </script>
  <meta charset="UTF-8" />
  <!-- The viewport-fit=cover makes sure your PWA can cover the full screen on devices with notches -->
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta property="og:title" content="UDOT Cameras">
  <meta property="og:description" content="Interact with UDOT Cameras in a grid format">
  <meta property="og:image" content="https://udotcameras.com/Icongridbackground3.png">
  <meta property="og:url" content="https://udotcameras.com">
  <!-- Favicon -->
  <link rel="icon" href="/camIcon1.png" type="image/png">
  <!-- PWA Manifest & Theme Color -->
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#4C4E52">
  <!-- External CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="stylev4.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" />
  <title>UDOT Cameras</title>
</head>
<body>
  <!-- Splash Screen -->
  <div id="splashScreen" class="splash-screen">
    <!-- Desktop Splash Video -->
    <video id="desktopVideo" class="splash-video desktop-video" autoplay muted playsinline preload="auto">
      <source src="desktop-splash.mp4" type="video/mp4">
      Your browser does not support the video tag.
    </video>
    <!-- Mobile Splash Image -->
    <img id="mobileSplashImage" class="splash-image mobile-splash-image" src="images/mobileSplash.png" alt="Splash Image">
  </div>

  <!-- Selected Filters Container -->
  <div id="selectedFilters" class="selected-filters"></div>  

  <!-- Header Controls Container -->
  <div class="header-controls hidden-on-load">
    <!-- Camera Count Dropdown -->
    <div class="dropdown">
      <button id="cameraCount" class="dropdown-toggle button" type="button" data-bs-toggle="dropdown" aria-expanded="false" title="Menu">
        0 Cameras
      </button>
      <ul class="dropdown-menu glass-dropdown p-2" aria-labelledby="cameraCount">
        <li><a class="dropdown-item" href="#" data-modal="mobileAppModal">Mobile App</a></li>
        <li><a class="dropdown-item" href="#" data-modal="updateInfoModal">Update Info</a></li>
        <li><a class="dropdown-item" href="#" data-modal="aboutAppModal">About This App</a></li>
      </ul>
    </div>

    <!-- Combined Filter Dropdown with Sub-dropdowns -->
    <div class="dropdown">
      <button id="filterDropdownButton" class="dropdown-toggle button" type="button" data-bs-toggle="dropdown" data-bs-auto-close="outside" aria-expanded="false" title="Filter">
        <i class="fas fa-filter"></i>
      </button>
      <div class="dropdown-menu glass-dropdown p-3" aria-labelledby="filterDropdownButton" style="min-width:240px; max-width:280px; max-height:500px; overflow-y:auto;">
        <!-- Region Filter Sub-Dropdown -->
        <div class="mt-2">
          <button class="dropdown-toggle button" type="button" data-bs-toggle="collapse" data-bs-target="#regionOptions" aria-expanded="false" aria-controls="regionOptions" style="width: 100%; text-align: left;">
            <i class="fas fa-map"></i> Region
          </button>
          <div class="collapse" id="regionOptions">
            <ul class="list-unstyled m-0" id="regionFilterMenu">
              <!-- Options dynamically populated -->
            </ul>
          </div>
        </div>
        <!-- County Filter Sub-Dropdown -->
        <div class="mt-2">
          <button class="dropdown-toggle button" type="button" data-bs-toggle="collapse" data-bs-target="#countyOptions" aria-expanded="false" aria-controls="countyOptions" style="width: 100%; text-align: left;">
            <i class="fas fa-building"></i> County
          </button>
          <div class="collapse" id="countyOptions">
            <ul class="list-unstyled m-0" id="countyFilterMenu">
              <!-- Options dynamically populated -->
            </ul>
          </div>
        </div>
        <!-- City Filter Sub-Dropdown -->
        <div class="mt-2">
          <button class="dropdown-toggle button" type="button" data-bs-toggle="collapse" data-bs-target="#cityOptions" aria-expanded="false" aria-controls="cityOptions" style="width: 100%; text-align: left;">
            <i class="fas fa-city"></i> City
          </button>
          <div class="collapse" id="cityOptions">
            <ul class="list-unstyled m-0" id="cityFilterMenu">
              <!-- Options dynamically populated -->
            </ul>
          </div>
        </div>
        <!-- Maintenance Stations Filter Sub-Dropdown -->
        <div class="mt-2">
          <button class="dropdown-toggle button" type="button" data-bs-toggle="collapse" data-bs-target="#maintenanceOptions" aria-expanded="false" aria-controls="maintenanceOptions" style="width: 100%; text-align: left;">
            <i class="fas fa-warehouse"></i> Maintenance Stations
          </button>
          <div class="collapse" id="maintenanceOptions">
            <ul class="list-unstyled m-0" id="maintenanceStationMenu">
              <!-- Options dynamically populated -->
            </ul>
          </div>
        </div> 
        <!-- Other Filters Sub‑Dropdown -->
<div class="mt-2">
  <button
    class="dropdown‑toggle button"
    type="button"
    data-bs-toggle="collapse"
    data-bs-target="#otherFiltersOptions"
    aria-expanded="false"
    aria-controls="otherFiltersOptions"
    style="width:100%; text-align:left;"
  >
    <i class="fas fa-sliders-h"></i> Other Filters
  </button>
  <div class="collapse" id="otherFiltersOptions">
    <ul class="list-unstyled m-0" id="otherFiltersMenu">
      <li>
        <a
          class="dropdown-item"
          href="#"
          data-value="Inactive Cameras"
        >
          Inactive Cameras
        </a>
      </li>
      <!-- future filter items go here -->
    </ul>
  </div>
</div>
       
      </div>
    </div>

    <!-- Curated Routes Dropdown -->
    <div class="dropdown">
      <button id="routeFilterButton" class="dropdown-toggle button" type="button" data-bs-toggle="dropdown" aria-expanded="false" title="Routes">
        <i class="fas fa-road"></i>
      </button>
      <ul class="dropdown-menu glass-dropdown p-2" id="routeFilterMenu">
        <li><a class="dropdown-item" href="#" data-value="All">All Routes</a></li>
      </ul>
    </div>

    <!-- Search Dropdown -->
    <div class="dropdown">
      <button id="searchDropdownButton" class="dropdown-toggle button" type="button" data-bs-toggle="dropdown" aria-expanded="false" title="Search">
        <i class="fas fa-search"></i>
      </button>
      <div class="dropdown-menu glass-dropdown p-3" style="min-width: 250px;" aria-label="Search options">
        <input type="text" id="searchInput" placeholder="Camera Name" class="form-control glass-dropdown-input" />
      </div>
    </div>

    <!-- Nearest Camera Button -->
    <button id="nearestButton" class="button" title="Show Nearest Camera">
      <i class="fas fa-location-arrow"></i>
    </button>

    <!-- Image Size Slider -->
    <div id="sizeControlContainer" class="dropdown-control">
      <div id="sizeControlButton" class="button">
        <i class="fas fa-compress"></i> <i class="fas fa-expand"></i>
      </div>
      <div id="sizeSliderContainer" class="slider-dropdown">
        <input id="sizeSlider" type="range" min="80" max="380" value="180" step="2" class="vertical-slider">
      </div>
    </div>

    <button id="refreshButton" class="button" title="Refresh Images">
      <i class="fas fa-sync"></i>
    </button>
  </div>
 
  <!-- Image Gallery -->
  <div class="container-fluid">
    <div id="imageGallery" class="container-fluid hidden-on-load"></div>
  </div>

  <!-- Modal -->
  <div class="modal fade" id="imageModal" tabindex="-1" aria-labelledby="imageModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg draggable-modal">
      <div class="modal-content glass-modal">
        <div class="modal-header">
          <h5 class="modal-title" id="imageModalLabel">Camera Location</h5>
        </div>
        <div class="modal-body" id="modalBody" style="display: flex; flex-direction: row;">
          <div id="modalImageContainer" style="width: 100%;">
            <img id="modalImage" src="" alt="Camera Image">
          </div>
          <!-- The map container will be injected here dynamically -->
        </div>
        <div class="modal-footer">
          <!-- Map Toggle Button -->
          <button id="mapButton" type="button" class="button" title="Show Map">Map</button>
          <!-- Close Button -->
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
      </div>
    </div>
  </div>

  <!-- Mobile App Modal -->
  <div class="modal fade" id="mobileAppModal" tabindex="-1" aria-labelledby="mobileAppLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered">
      <div class="modal-content glass-modal">
        <div class="modal-header">
          <h5 class="modal-title fw-bold" id="mobileAppLabel">Mobile App</h5>
        </div>
        <div class="modal-body text-center p-4" style="max-width: 100%; overflow: hidden;">
          <p id="mobileAppText" class="mb-3 text-white">
            Add to Home Screen for a more app like experience!
          </p>        
        </div>
        <div style="width: 100%; max-width: 600px; margin: 0 auto;">
          <img src="WebAppHowTo.gif"
               alt="Mobile App Demo"
               class="img-fluid rounded shadow"
               style="width: 100%; height: auto;" />
        </div>
        <div class="modal-footer justify-content-center">
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
      </div>
    </div>
  </div>

  <!-- Update Info Modal -->
  <div class="modal fade" id="updateInfoModal" tabindex="-1" aria-labelledby="updateInfoLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content glass-modal">
        <div class="modal-header">
          <h5 class="modal-title fw-bold" id="updateInfoLabel">Update Info</h5>
        </div>
        <div class="modal-body text-white">
          <ul class="update-list">
            <li class="update-header">Last Camera List Update: 4/5/2025</li>
            <li>03/22/2025 – The Routes filter is created from a predefined list of routes and milepost extents. Routes are generated dynamically from the camera name by parsing out the route and milepost. Images will be added to one of these routes automatically as often as UDOT updates their database and this app updates the main camera list. For an image to appear in a route, the camera name must contain both a route name and a milepost number.</li>
            <li>03/30/2025 – Added bookmarkable views! With URL parameters, users can now copy and share a unique URL that preserves the current filter settings.</li>
            <li>04/04/2025 – New Maintenance Station filter!</li>
          </ul>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
      </div>
    </div>
  </div>

  <!-- About This App Modal -->
  <div class="modal fade" id="aboutAppModal" tabindex="-1" aria-labelledby="aboutAppLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content glass-modal">
        <div class="modal-header">
          <h5 class="modal-title fw-bold" id="aboutAppLabel">About This App</h5>
        </div>
        <div class="modal-body text-white">
          <ul class="update-list">
            <li class="update-header">View and explore UDOT Traffic cameras!</li>
            <li>This Progressive Web App (PWA) can be viewed in a web browser or installed as an app.
                A PWA is installed as an app within a web browser while viewing udotcameras.com, not in the App Store or Google Play.</li>
            <li>This website is not associated with UDOT and is not a product of UDOT.
                 udotcameras.com is independently developed as an experiment and a fun, convenient way to look at cameras.</li>
          </ul>
        </div>
       <div style="width: 100%; max-width: 60px; margin: 0 auto;">
          <img src="camIcon2.png"
               alt="UDOT Cameras"
               class="img-fluid rounded shadow"
               style="width: 100%; height: auto;" />
        </div>
        <div class="modal-footer">
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
      </div>
    </div>
  </div>

  <!-- External JavaScript Files -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/js/all.min.js"></script>
  <!-- Load your modular JavaScript -->
  

  
  <!-- Service Worker Registration -->
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', function() {
        navigator.serviceWorker.register('sw.js')
          .then(function(registration) {
            console.log('Service Worker registered with scope:', registration.scope);
          })
          .catch(function(error) {
            console.log('Service Worker registration failed:', error);
          });
      });
    }
  </script>
  
  <!-- Viewport Height Fix for PWAs -->
  <script>
    function setVh() {
      let vh = window.innerHeight * 0.01;
      document.documentElement.style.setProperty('--vh', `${vh}px`);
    }
    window.addEventListener('resize', setVh);
    document.addEventListener('DOMContentLoaded', setVh);
  </script>
  
  <script type="module" src="js/main.js"></script>


</body>
</html>
